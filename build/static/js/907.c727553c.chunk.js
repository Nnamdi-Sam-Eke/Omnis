"use strict";(self.webpackChunkdigital_twin_app=self.webpackChunkdigital_twin_app||[]).push([[907],{907:(e,r,s)=>{s.r(r),s.d(r,{default:()=>b});var t=s(339),a=s(805),l=s(222);var i=s(502),n=s(133),o=s(940),d=s(647),c=s(931);function h(e){let{onSimulate:r}=e;const[s,h]=(0,t.useState)([""]),[u,x]=(0,t.useState)(!1),[m,g]=(0,t.useState)([]),[p,b]=(0,t.useState)(!1),{memory:v,saveToFirestore:j}=(0,i.P)(),[y,f]=(0,t.useState)([]),{user:N}=(0,n.A)();(0,t.useEffect)((()=>{N&&w()}),[N]);const w=async()=>{if(N)try{const e=(0,l.P)((0,l.rJ)(a.db,"users",N.uid,"memory"),(0,l.My)("timestamp","desc")),r=(await(0,l.GG)(e)).docs.map((e=>e.data()));console.log("\u2705 Firestore Memory Loaded:",r)}catch(e){console.error("\u274c Error loading Firestore memory:",e)}};return(0,c.jsxs)("div",{className:"relative",children:[p&&(0,c.jsx)("div",{className:"fixed inset-0 bg-black transition bg-opacity-50 flex items-center justify-center z-50",children:(0,c.jsxs)("div",{className:"relative flex items-center justify-center",children:[(0,c.jsx)("div",{className:"absolute w-16 h-16 border-8 border-blue-500 border-t-transparent rounded-full animate-spin"}),(0,c.jsx)("div",{className:"w-12 h-12 border-8 border-green-500 border-t-transparent rounded-full animate-[spin_1s_linear_reverse_infinite]"})]})}),(0,c.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow-lg hover:shadow-blue-500/50 rounded-lg p-6 border text-gray-900 dark:text-white",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center cursor-pointer p-3 bg-white rounded-md dark:bg-gray-800",onClick:()=>x(!u),children:[(0,c.jsx)("h2",{className:"text-xl font-semibold text-blue-500 dark:text-blue-300",children:"Scenario Input"}),(0,c.jsx)("span",{className:"text-blue-500 dark:text-blue-300 font-medium",children:u?(0,c.jsx)(o.A,{}):(0,c.jsx)(d.A,{})})]}),u&&(0,c.jsx)("div",{className:"overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200 overflow-hidden transition-all duration-300 max-h-[300px] opacity-100 mt-4",children:s.map(((e,r)=>(0,c.jsxs)("div",{className:"mb-4 p-4 rounded-lg shadow-sm border border-gray-300",children:[(0,c.jsx)("input",{type:"text",placeholder:`Enter scenario ${r+1}...`,value:e,onChange:e=>((e,r)=>{const t=[...s];t[e]=r,h(t)})(r,e.target.value),className:"w-full p-2 border rounded bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,c.jsx)("button",{onClick:()=>(e=>{s.length>1&&h(s.filter(((r,s)=>s!==e)))})(r),disabled:1===s.length,className:"mt-2 px-3 py-2 bg-gray-500 text-white rounded-full hover:scale-105",children:"Remove"})]},r)))}),(0,c.jsxs)("div",{className:"flex gap-1 mt-4",children:[(0,c.jsx)("button",{onClick:()=>{h([...s,""])},className:"px-4 py-2 bg-blue-600 text-white rounded-full hover:scale-105",children:"Add Scenario"}),(0,c.jsx)("button",{onClick:async()=>{const e=s.filter((e=>""!==e.trim()));if(!e.length)return;b(!0),console.log("\ud83d\udcca Simulating scenario:",e),await(async(e,r,s)=>{try{console.log("\ud83d\udce4 Saving user interaction:",{userId:e,action:r,details:s});const t=await(0,l.gS)((0,l.rJ)(a.db,"userInteractions"),{userId:e,action:r,details:s,timestamp:(0,l.O5)()});console.log("\u2705 User interaction saved with ID:",t.id)}catch(t){console.error("\u274c Error saving user interaction:",t)}})("test_user_123","simulate_scenario",{scenarios:e});const t=e.map((async e=>{const{endpoint:r,location:s}=(e=>{let r="",s={};if(/weather history/i.test(e))r="/api/weather-history",s={location:e.replace(/.*(?:weather history for|weather history in|for)\s+/i,"").trim()};else if(/weather alerts|weather warning|storm alert|severe weather/i.test(e))r="/api/weather-alerts",s={location:e.replace(/.*(?:weather alerts for|weather alerts in|for)\s+/i,"").trim()};else if(/weather/i.test(e))r="/api/weather",s={location:e.replace(/.*(?:weather in)\s+/i,"").trim()};else if(/forecast/i.test(e))r="/api/forecast",s={location:e.replace(/.*(?:forecast in| weather forecast for)\s+/i,"").trim()};else if(/geocode/i.test(e))r="/api/geocode",s={location:e.replace(/.*(?:geocode)\s+/i,"").trim()};else if(/\d+\.\d+\s*,\s*\d+\.\d+/.test(e)){r="/api/reverse_geocode";const[t,a]=e.split(",").map((e=>e.trim()));s={latitude:parseFloat(t),longitude:parseFloat(a)}}else r="/api/gemini",s={query:e.trim()};var t,a,l;return t=7,a=5,l=8,fetch("/api/evaluate_decision",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({risk:t,probability:a,impact:l})}).then((e=>e.json())).then((e=>{e.total_score&&e.decision?(console.log(`Total Score: ${e.total_score}`),console.log(`Decision: ${e.decision}`)):console.error("Error in response:",e.error)})).catch((e=>console.error("Error:",e))),{endpoint:r,location:s}})(e);if(!r||0===Object.keys(s).length)return null;const t=v.slice(-3).map((e=>e.response)).join("\n");try{console.log(`\ud83d\udce4 Sending request to: ${r} with location:`,s);const i=await fetch(`http://127.0.0.1:5000${r}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...s,context:t})});if(!i.ok)throw new Error(`HTTP error! Status: ${i.status}`);const n=await i.json();return console.log(`\u2705 Response from ${r}:`,n),j(e,n),await(0,l.gS)((0,l.rJ)(a.db,"chatHistory"),{scenario:e,outcome:n,timestamp:new Date}),f((r=>[...r,{query:e,response:n}])),{query:e,response:n}}catch(i){return console.error(`\u274c Error fetching from ${r}:`,i),{query:e,error:i.message}}})),i=await Promise.all(t.filter(Boolean));console.log("\ud83d\udd0d Final results:",i),g(i),b(!1),r&&r(i)},disabled:s.every((e=>""===e.trim())),className:"px-4 py-2 bg-green-600 text-white rounded-full hover:scale-105",children:p?"Simulating...":"Simulate"})]})]}),m.length>0&&(0,c.jsxs)("div",{className:"mt-4 bg-white dark:bg-gray-800 p-4 border rounded-lg",children:[(0,c.jsx)("h3",{className:"text-lg font-semibold text-blue-500 dark:text-blue-300",children:"Simulation Results"}),m.map(((e,r)=>(0,c.jsxs)("div",{className:"mb-4",children:[(0,c.jsx)("h4",{className:"font-semibold text-blue-500 dark:text-blue-300",children:e.query}),(0,c.jsx)("pre",{className:"bg-gray-100 dark:bg-gray-700 p-4 rounded-md text-sm",children:JSON.stringify(e.response,null,2)})]},r)))]})]})}var u=s(523),x=s(94);function m(e){var r;return console.log("\u2705 Full API Response:",e),e&&"object"===typeof e?(0,c.jsxs)("div",{children:[e.candidates&&e.candidates.length>0&&e.candidates[0].content.parts.length>0&&(0,c.jsxs)("div",{className:"group hover:scale-105 transition-transform duration-200",children:[(0,c.jsxs)("p",{children:["\ud83e\udd16 ",(0,c.jsx)("strong",{children:"AI Response:"})]}),(0,c.jsx)("p",{className:"text-gray-700 dark:text-gray-300",children:e.candidates[0].content.parts[0].text})]}),"success"===e.status&&e.data&&"object"===typeof e.data&&!Array.isArray(e.data)&&(0,c.jsxs)("div",{className:"mb-3 group hover:scale-105 transition-transform duration-200",children:[(0,c.jsxs)("p",{children:["\ud83c\udf0d ",(0,c.jsx)("strong",{children:"Location:"})," ",e.data.location||"N/A"]}),(0,c.jsxs)("p",{children:["\ud83c\udf21\ufe0f ",(0,c.jsx)("strong",{children:"Temperature:"})," ",e.data.temperature||"N/A","\xb0C"]}),(0,c.jsxs)("p",{children:["\u26c5 ",(0,c.jsx)("strong",{children:"Condition:"})," ",e.data.description||"N/A"]}),e.data.icon?(0,c.jsx)("img",{src:`https:${e.data.icon}`,alt:"Weather Icon",className:"w-10 h-10"}):(0,c.jsx)("p",{children:"\u26a0\ufe0f No Weather Icon Available"})]}),"success"===e.status&&(null===(r=e.data)||void 0===r?void 0:r.forecast)&&e.data.forecast.length>0&&(0,c.jsxs)("div",{className:"mt-3",children:[(0,c.jsxs)("p",{children:["\ud83d\udcc5 ",(0,c.jsx)("strong",{children:"3-Day Forecast:"})]}),e.data.forecast.slice(0,4).map(((e,r)=>{var s,t,a,l,i,n;return(0,c.jsxs)("div",{className:"mt-2 p-3 border border-gray-300 dark:border-gray-600 rounded bg-gray-100 dark:bg-gray-700 group hover:scale-105 transition-transform duration-200",children:[(0,c.jsxs)("p",{children:["\ud83d\udcc6 ",(0,c.jsx)("strong",{children:"Date:"})," ",(null===e||void 0===e?void 0:e.date)||"N/A"]}),(0,c.jsxs)("p",{children:["\ud83c\udf21\ufe0f ",(0,c.jsx)("strong",{children:"Max Temp:"})," ",(null===e||void 0===e||null===(s=e.day)||void 0===s?void 0:s.maxtemp_c)||"N/A","\xb0C"]}),(0,c.jsxs)("p",{children:["\ud83c\udf21\ufe0f ",(0,c.jsx)("strong",{children:"Min Temp:"})," ",(null===e||void 0===e||null===(t=e.day)||void 0===t?void 0:t.mintemp_c)||"N/A","\xb0C"]}),(0,c.jsxs)("p",{children:["\u26c5 ",(0,c.jsx)("strong",{children:"Condition:"})," ",(null===e||void 0===e||null===(a=e.day)||void 0===a||null===(l=a.condition)||void 0===l?void 0:l.text)||"N/A"]}),null!==e&&void 0!==e&&null!==(i=e.day)&&void 0!==i&&null!==(n=i.condition)&&void 0!==n&&n.icon?(0,c.jsx)("img",{src:`https:${e.day.condition.icon}`,alt:"Forecast Icon",className:"w-10 h-10"}):(0,c.jsx)("p",{children:"\u26a0\ufe0f No Weather Icon Available"})]},r)}))]}),"success"===e.status&&e.history&&Array.isArray(e.history)&&e.history.length>0&&(0,c.jsxs)("div",{className:"mt-3",children:[(0,c.jsxs)("p",{children:["\ud83d\udcdc ",(0,c.jsx)("strong",{children:"5-Day Weather History:"})]}),e.history.slice(0,5).map(((e,r)=>{var s,t,a,l,i,n;return(0,c.jsxs)("div",{className:"mt-2 p-3 border border-gray-300 dark:border-gray-600 rounded bg-gray-100 dark:bg-gray-700 group hover:scale-105 transition-transform duration-200",children:[(0,c.jsxs)("p",{children:["\ud83d\udcc6 ",(0,c.jsx)("strong",{children:"Date:"})," ",(null===e||void 0===e?void 0:e.date)||"N/A"]}),(0,c.jsxs)("p",{children:["\ud83c\udf21\ufe0f ",(0,c.jsx)("strong",{children:"Max Temp:"})," ",(null===e||void 0===e||null===(s=e.day)||void 0===s?void 0:s.maxtemp_c)||"N/A","\xb0C"]}),(0,c.jsxs)("p",{children:["\ud83c\udf21\ufe0f ",(0,c.jsx)("strong",{children:"Min Temp:"})," ",(null===e||void 0===e||null===(t=e.day)||void 0===t?void 0:t.mintemp_c)||"N/A","\xb0C"]}),(0,c.jsxs)("p",{children:["\u26c5 ",(0,c.jsx)("strong",{children:"Condition:"})," ",(null===e||void 0===e||null===(a=e.day)||void 0===a||null===(l=a.condition)||void 0===l?void 0:l.text)||"N/A"]}),null!==e&&void 0!==e&&null!==(i=e.day)&&void 0!==i&&null!==(n=i.condition)&&void 0!==n&&n.icon?(0,c.jsx)("img",{src:`https:${e.day.condition.icon}`,alt:"History Icon",className:"w-10 h-10"}):(0,c.jsx)("p",{children:"\u26a0\ufe0f No Weather Icon Available"})]},r)}))]}),e.address&&"object"===typeof e.address&&"lat"in e.address&&"lng"in e.address&&(0,c.jsxs)("div",{className:"group hover:scale-105 transition-transform duration-200",children:[(0,c.jsxs)("p",{children:["\ud83d\udccd ",(0,c.jsx)("strong",{children:"Coordinates:"})]}),(0,c.jsxs)("p",{children:["\ud83c\udf0e ",(0,c.jsx)("strong",{children:"Latitude:"})," ",e.address.lat]}),(0,c.jsxs)("p",{children:["\ud83c\udf0d ",(0,c.jsx)("strong",{children:"Longitude:"})," ",e.address.lng]})]}),e.address&&"string"===typeof e.address&&(0,c.jsx)("div",{className:"group hover:scale-105 transition-transform duration-200",children:(0,c.jsxs)("p",{children:["\ud83c\udfe0 ",(0,c.jsx)("strong",{children:"Formatted Address:"})," ",e.address]})}),!e.candidates&&!e.data&&!e.address&&!e.history&&(0,c.jsx)("p",{className:"group hover:scale-105 transition-transform duration-200",children:"\u274c No structured data available."})]}):(0,c.jsx)("p",{className:"group-hover:scale-100 text-3xl transition-transform duration-200",children:"\u274c Invalid response received."})}const g=e=>{let{results:r,setResults:s}=e;const{addFeedback:a}=(0,u.Z)(),[l,i]=(0,t.useState)(null),[n,o]=(0,t.useState)(null);if(!r||0===r.length)return(0,c.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow-lg border hover:shadow-blue-500/50 rounded-lg p-6 border text-gray-900 dark:text-white",children:[(0,c.jsx)("h2",{className:"text-xl font-semibold text-blue-500 dark:text-blue-300",children:"Scenario Output"}),(0,c.jsx)("p",{className:"text-gray-500 text-center mt-4",children:"No results to display."})]});const d=(e,r)=>{console.log(`Feedback button clicked! Timestamp: ${e}, Feedback: ${r}`),i(r),setTimeout((()=>{i(null)}),5e3),a(e,r)};return(0,c.jsxs)("div",{className:"bg-white shadow-lg hover:shadow-blue-500/50 dark:bg-gray-900 rounded-lg p-6 border dark:border text-gray-900 dark:text-white text-2xl col-span-2 w-full",children:[(0,c.jsx)("h2",{className:"text-xl font-semibold text-blue-500 dark:text-blue-300",children:"Scenario Output"}),(0,c.jsx)("div",{className:"max-h-40 overflow-y-auto scrollbar-thin scrollbar-thumb-gray-400 scrollbar-track-gray-200 p-2 mt-3",children:r.filter(Boolean).map(((e,r)=>(0,c.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-full shadow border border-gray-200 dark:border-gray-700 mb-3 group hover:scale-100 transition-transform duration-200",children:[(0,c.jsx)("h4",{className:"text-md font-medium text-gray-700 dark:text-gray-200",children:(null===e||void 0===e?void 0:e.query)||"Unknown Query"}),null!==e&&void 0!==e&&e.error?(0,c.jsxs)("p",{className:"text-red-500 text-sm",children:["\u274c ",e.error]}):(0,c.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-300 mt-2",children:m(null===e||void 0===e?void 0:e.response)}),(0,c.jsxs)("div",{className:"flex justify-start space-x-4 mt-2",children:[(0,c.jsxs)("button",{className:("positive"===l?"bg-green-600":"bg-green-500")+" hover:bg-green-600 text-white px-3 py-1 rounded-lg transition-transform transform hover:scale-105",onClick:()=>d(null===e||void 0===e?void 0:e.timestamp,"positive"),children:[(0,c.jsx)(x.Ydy,{className:"text-xl"})," "]}),(0,c.jsxs)("button",{className:("negative"===l?"bg-red-600":"bg-red-500")+" hover:bg-red-600 text-white px-3 py-1 rounded-lg transition-transform transform hover:scale-105",onClick:()=>d(null===e||void 0===e?void 0:e.timestamp,"negative"),children:[(0,c.jsx)(x.rxb,{className:"text-xl"})," "]})]})]},r)))}),(0,c.jsx)("div",{className:"flex justify-end mt-4",children:(0,c.jsx)("button",{onClick:()=>{s&&s([])},className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-full transition-transform transform hover:scale-100 active:scale-95",children:"Reset"})})]})},p=e=>{let{processedData:r=[]}=e;const[s,a]=(0,t.useState)("bar"),[l,i]=(0,t.useState)(!1);0===r.length&&(r=[{label:"Scenario A",value:45},{label:"Scenario B",value:75},{label:"Scenario C",value:30}]),(0,t.useEffect)((()=>{const e=localStorage.getItem("scenarioCardIsOpen");null!==e&&i(JSON.parse(e))}),[]),(0,t.useEffect)((()=>{localStorage.setItem("scenarioCardIsOpen",JSON.stringify(l))}),[l]);return(0,c.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow-lg hover:shadow-blue-500/50 rounded-lg p-6 border text-gray-900 dark:text-white",children:[(0,c.jsxs)("div",{className:"flex justify-between items-center",children:[(0,c.jsx)("h2",{className:"text-xl font-semibold text-blue-500 dark:text-blue-300",children:"Scenario Insights"}),(0,c.jsx)("button",{onClick:()=>i(!l),className:"text-blue-500 dark:text-blue-300 font-mediu",children:l?(0,c.jsx)(o.A,{}):(0,c.jsx)(d.A,{})})]}),l&&(0,c.jsxs)("div",{className:"mt-4",children:[(0,c.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"Analyze trends and patterns from scenario data."}),(0,c.jsx)("label",{className:"block text-gray-700 dark:text-gray-300 mb-2",children:"Select Chart Type:"}),(0,c.jsxs)("select",{value:s,onChange:e=>a(e.target.value),className:"mb-6 p-2 border rounded w-full dark:bg-gray-700 dark:text-white",children:[(0,c.jsx)("option",{value:"bar",children:"Bar Chart"}),(0,c.jsx)("option",{value:"line",children:"Line Chart"}),(0,c.jsx)("option",{value:"heatmap",children:"Heatmap"}),(0,c.jsx)("option",{value:"pie",children:"Pie Chart"}),(0,c.jsx)("option",{value:"circular-progress",children:"Circular Progress"})]}),r&&0!==r.length?(0,c.jsxs)("div",{className:"border p-4 rounded-lg bg-gray-100",children:[(0,c.jsxs)("h3",{className:"text-lg font-bold mb-2",children:["Chart Preview (",s,")"]}),(0,c.jsx)("ul",{className:"space-y-2",children:r.map(((e,r)=>(0,c.jsxs)("li",{className:"flex justify-between",children:[(0,c.jsx)("span",{children:e.label}),(0,c.jsx)("span",{children:e.value})]},r)))})]}):(0,c.jsx)("p",{className:"text-gray-500",children:"No data available"})," "]})]})},b=()=>(0,c.jsxs)("div",{className:"p-6 space-y-10",children:[(0,c.jsxs)("header",{children:[(0,c.jsx)("h1",{className:"text-3xl font-bold text-blue-600 dark:text-blue-300",children:"Omnis' Core"}),(0,c.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm mt-1",children:"Design and test your decision-making scenarios here."})]}),(0,c.jsxs)("section",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,c.jsx)("div",{className:"w-full",children:(0,c.jsx)(h,{})}),(0,c.jsxs)("div",{className:"bg-white dark:bg-gray-800 border shadow-lg hover:shadow-blue-500/50 rounded-lg p-6 ",children:[(0,c.jsx)("h2",{className:"text-xl font-semibold text-blue-500 dark:text-blue-300 mb-2",children:"Scenario Preview"}),(0,c.jsx)("p",{className:"text-gray-500  dark:text-gray-400 text-center mt-6",children:"Your live scenario preview will appear here based on current inputs."})]})]}),(0,c.jsxs)("section",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,c.jsx)("div",{children:(0,c.jsx)(g,{})}),(0,c.jsx)("div",{children:(0,c.jsx)(p,{})})]})]})}}]);
//# sourceMappingURL=907.c727553c.chunk.js.map