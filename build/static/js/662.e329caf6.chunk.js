"use strict";(self.webpackChunkomnis=self.webpackChunkomnis||[]).push([[662],{3662:(e,t,a)=>{a.r(t),a.d(t,{default:()=>AnalyticsOverview});var s=a(5043),i=a(4895),o=a(5472),n=a(7304),r=(a(5595),a(6058)),l=a(2308),c=a(579);n.t1.register(...n.$L);const KpiCard=e=>{let{title:t,value:a,icon:s}=e;return(0,c.jsxs)(l.P.div,{className:"bg-white dark:bg-gray-900 p-6 rounded-2xl shadow-lg flex flex-col items-center text-center hover:shadow-2xl transition-shadow",initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.5},children:[s&&(0,c.jsx)("div",{className:"text-4xl mb-2 text-blue-500",children:s}),(0,c.jsx)("h4",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300",children:t}),(0,c.jsx)("p",{className:"text-3xl font-bold text-green-500 mt-2",children:a})]})};function AnalyticsOverview(){const[e,t]=(0,s.useState)(0),[a,n]=(0,s.useState)(0),[d,m]=(0,s.useState)(0),[g,u]=(0,s.useState)([]),[p,x]=(0,s.useState)(!1),f=(new Date).toISOString().split("T")[0],endSession=()=>{const e=parseInt(localStorage.getItem("sessionStart"),10);if(e){const t=Date.now()-e,a=(parseInt(localStorage.getItem(`dailyUptime_${f}`),10)||0)+t;localStorage.setItem(`dailyUptime_${f}`,a),m(a)}localStorage.removeItem("sessionStart"),localStorage.setItem("sessionActive","false"),x(!1)};(0,s.useEffect)((()=>{const e="true"===localStorage.getItem("sessionActive");x(e);const t=parseInt(localStorage.getItem(`dailyUptime_${f}`),10)||0;return m(t),e||(()=>{if(!p){const e=Date.now();localStorage.setItem("sessionStart",e),localStorage.setItem("sessionActive","true"),x(!0)}})(),window.addEventListener("beforeunload",endSession),()=>{endSession(),window.removeEventListener("beforeunload",endSession)}}),[]),(0,s.useEffect)((()=>{const e=setInterval((()=>{if(p){const e=parseInt(localStorage.getItem("sessionStart"),10);if(e){const t=Date.now()-e,a=(parseInt(localStorage.getItem(`dailyUptime_${f}`),10)||0)+t;m(a),u((e=>[...e,{time:(new Date).toLocaleTimeString(),uptime:Math.floor(a/6e4)}])),localStorage.setItem(`dailyUptime_${f}`,a)}}}),6e4);return()=>clearInterval(e)}),[p]),(0,s.useEffect)((()=>{const e=parseInt(localStorage.getItem("sessionCount")||"0",10);t(e)}),[]),(0,s.useEffect)((()=>{(async()=>{const e=new Date;e.setHours(0,0,0,0);const t=new Date;t.setHours(23,59,59,999);const a=(0,o.P)((0,o.rJ)(i.db,"scenarios"),(0,o._M)("date",">=",e),(0,o._M)("date","<=",t)),s=await(0,o.GG)(a);n(s.size)})()}),[]);const y={labels:g.map((e=>e.time)),datasets:[{label:"Uptime (minutes)",data:g.map((e=>e.uptime)),borderColor:"#3b82f6",backgroundColor:"rgba(59, 130, 246, 0.2)",tension:.4,pointRadius:3}]};return(0,c.jsxs)("div",{className:"analytics-overview p-6 bg-gray-50 dark:bg-gray-800 min-h-screen",children:[(0,c.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 mb-10",children:[(0,c.jsx)(KpiCard,{title:"Total Sessions Today",value:e,icon:(0,c.jsx)("i",{className:"fas fa-history"})}),(0,c.jsx)(KpiCard,{title:"Scenarios Run Today",value:a,icon:(0,c.jsx)("i",{className:"fas fa-tasks"})}),(0,c.jsx)(KpiCard,{title:"Daily Uptime",value:(e=>{const t=Math.floor(e/6e4);return`${String(Math.floor(t/60)).padStart(2,"0")}h ${String(t%60).padStart(2,"0")}m`})(d),icon:(0,c.jsx)("i",{className:"fas fa-clock"})})]}),(0,c.jsxs)(l.P.div,{className:"bg-white dark:bg-gray-900 p-4 rounded-xl shadow-lg",initial:{opacity:0},animate:{opacity:1},transition:{duration:.7},children:[(0,c.jsx)("h3",{className:"text-lg font-semibold mb-4 text-gray-700 dark:text-gray-300",children:"Uptime Trend"}),(0,c.jsx)(r.Line,{data:y,options:{responsive:!0,plugins:{legend:{display:!1},tooltip:{mode:"index",intersect:!1}},scales:{x:{title:{display:!0,text:"Time"}},y:{beginAtZero:!0,title:{display:!0,text:"Minutes"}}},animation:{duration:800}}})]}),(0,c.jsx)("div",{className:"mt-8 flex justify-center",children:(0,c.jsx)("button",{onClick:endSession,className:"px-5 py-3 bg-red-500 text-white rounded-full shadow hover:bg-red-600 transition transform hover:scale-105",children:"End Session"})})]})}}}]);
//# sourceMappingURL=662.e329caf6.chunk.js.map